(()=>{const e=window.open;window.open=function(...t){const n=e.apply(window,t);try{n&&(n.opener=null)}catch{}return n}})();const e={phase:0,foundFlags:new Set,awardFlag(e,n,s){this.foundFlags.has(e)||(this.foundFlags.add(e),s(`<span class="success-message">[+] FLAG ${e} conquistada:</span> ${n}`),1===e?s('<span class="info-message">Analise o trÃ¡fego em /home/analyst/pcap</span>'):2===e?(t["/"].children.root.children["FLAG3.txt"]={type:"file",content:"flag{4dm1n_r00t_pwn3d}"},s('<span class="info-message">Explore SMB 10.10.10.30 com metasploit</span>')):3===e&&(t["/"].children.root.children["flag_final.txt"]={type:"file",content:"flag{ultimate_victory}"},s('<br><span class="success-message">CTF COMPLETO â€“ parabÃ©ns! ğŸ‰</span>'),s('<span class="info-message">Dica: ls em /root ğŸ˜‰</span>')))}},t={"/":{type:"directory",children:{bin:{type:"directory",children:{"suid-cat":{type:"file",content:"ELFâ€¦"}}},etc:{type:"directory",children:{passwd:{type:"file",content:"root:x:0:0:root:/root:/bin/bash\nanalyst:x:1001:1001:Network Analyst:/home/analyst:/bin/bash\ndev:x:1002:1002:Junior Dev:/home/dev:/bin/bash"},shadow:{type:"file",content:"root:$6$...\nanalyst:!!\ndev:$6$..."}}},home:{type:"directory",children:{dev:{type:"directory",perms:"750",children:{projects:{type:"directory",children:{src:{type:"directory",children:{"secret.cpp":{type:"file",content:"#include <iostream> // senha escondida"}}},"FLAG1.txt":{type:"file",content:"flag{g0bu5t3r_rocks}"}}},".ssh":{type:"directory",perms:"700",children:{id_rsa:{type:"file",content:"-----BEGIN OPENSSH PRIVATE KEY-----"}}},"README.md":{type:"file",content:"HÃ¡ um backup (.tar.gz) em 10.10.10.30:21 (FTP)"}}},analyst:{type:"directory",children:{pcap:{type:"directory",children:{"http_leak.pcap":{type:"file",content:"(dados binÃ¡rios)"}}},notes:{type:"directory",children:{"to-root.txt":{type:"file",content:"Hint: exploit o suid-cat para ler /root/..."}}},"FLAG2.txt":{type:"file",content:"flag{p4ck3t_sn1ff3r}"}}}}},opt:{type:"directory",children:{targets:{type:"directory",children:{internal_web:{type:"directory",children:{"backup.zip":{type:"file",content:"PKâ€¦ (senha=SameAsUser)"}}}}}}},tmp:{type:"directory",perms:"777",children:{}},var:{type:"directory",children:{log:{type:"directory",children:{apache:{type:"directory",children:{"access.log":{type:"file",content:'192.168.56.1 - - "GET /secret.txt HTTP/1.1" 200 -'}}}}}}},root:{type:"directory",perms:"700",children:{Desktop:{type:"directory",children:{}},Documents:{type:"directory",children:{"notes.txt":{type:"file",content:"Use nmap â€“sC â€“p445 10.10.10.30"}}},Downloads:{type:"directory",children:{}}}}}}};function n(n,s=0){const a=n.querySelector(".terminal-output"),r=n.querySelector(".terminal-input");r.setAttribute("maxlength","5000"),r.setAttribute("autocapitalize","off"),r.setAttribute("autocomplete","off");const o=n.querySelector(".terminal-prompt"),c=n.querySelector(".currentPathHeader, #currentPathHeader"),l=n.querySelector(".closeTerminalBtn, #closeTerminalBtn");let i="analyst",p="/home/analyst";const d={dev:"P@ssw0rdDev!",analyst:"Passw0rd!"};let u=[],m=-1,h=!1;const y={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},f=e=>String(e).replace(/[&<>"']/g,e=>y[e]);function g(e,t=""){const n=document.createElement("div");t&&(n.className=t),n.textContent=String(e),a.appendChild(n),a.scrollTop=a.scrollHeight}function b(e,t=""){const n=document.createElement("div");t&&(n.className=t),n.innerHTML=String(e),a.appendChild(n),a.scrollTop=a.scrollHeight}function w(e){const t=document.createElement("div");t.appendChild(function(){const e=document.createElement("span"),t=p.replace(`/home/${i}`,"~").replace("/root","~"),n="root"===i?"#ff5555":"#50fa7b";return e.innerHTML=`<span style="color:${n}">${f(i)}@kali</span><span class="prompt-host">:</span><span class="prompt-path">${f(t)}</span><span class="prompt-symbol"># </span>`,e}()),t.appendChild(document.createTextNode(e)),a.appendChild(t),a.scrollTop=a.scrollHeight}const k=()=>{const e=p.replace(`/home/${i}`,"~").replace("/root","~"),t="root"===i?"#ff5555":"#50fa7b";o.innerHTML=`<span style="color:${t}">${f(i)}@kali</span><span class="prompt-host">:</span><span class="prompt-path">${f(e)}</span><span class="prompt-symbol"># </span>`,c&&(c.textContent=`${i}:${e}`)},v=e=>{const n=e.split("/").filter(e=>e&&"."!==e);let s=t["/"];const a=[];e.startsWith("/")||a.push(...p.split("/").filter(e=>e));for(const e of n)".."===e?a.pop():a.push(e);for(const e of a){if(!s.children?.[e])return null;s=s.children[e]}return{node:s,full:"/"+a.join("/")}},E=n=>{"Enter"===n.key?(n.preventDefault(),(n=>{if(h)return;if(w(n),!n.trim())return;u.unshift(n),m=-1;const[s,...o]=n.trim().split(" ");switch(s){case"help":g("Comandos: ls, cd, cat, whoami, su, nmap, gobuster, wireshark, hydra, metasploit, clear.   Para retornar Ã  tela inicial, use exit.");break;case"ls":{const e=o[0]||p,t=v(e);t&&"directory"===t.node.type?b(Object.keys(t.node.children).map(e=>`<span class="${"directory"===t.node.children[e].type?"command-output-dir":"command-output-file"}">${f(e)}</span>`).join("  ")):g(`ls: ${o[0]||"."}: nÃ£o encontrado`,"error-message")}break;case"cd":{const e=o[0]||("root"===i?"/root":`/home/${i}`),t=v(e);t&&"directory"===t.node.type?p=t.full:g(`cd: ${o[0]||e}: nÃ£o Ã© diretÃ³rio`,"error-message")}break;case"cat":{const e=v(o[0]||"");e&&"file"===e.node.type?g(e.node.content):g(`cat: ${o[0]}: nÃ£o encontrado`,"error-message")}break;case"whoami":g(i);break;case"su":{const e=o[0];if(!e){g("su: especifique usuÃ¡rio","error-message");break}if(!d[e]){g(`su: usuÃ¡rio ${e} inexistente`,"error-message");break}h=!0,r.type="password",g(`Senha para ${e}:`);const t=n=>{if("Enter"===n.key){n.preventDefault();const s=r.value===d[e];r.value="",r.type="text",h=!1,s?(i=e,p=`/home/${i}`,g("Login bem-sucedido!","success-message")):g("su: falha na autenticaÃ§Ã£o","error-message"),r.removeEventListener("keydown",t),r.addEventListener("keydown",E),k()}};r.removeEventListener("keydown",E),r.addEventListener("keydown",t)}break;case"nmap":n.includes("10.10.10.10")?(g("PORT STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2\n80/tcp open  http    Apache 2.4.41"),b('<span class="info-message">Tente gobuster em http://10.10.10.10</span>')):n.includes("10.10.10.30")?(g("PORT STATE SERVICE\n445/tcp open microsoft-ds"),b('<span class="info-message">Talvez haja vulnerabilidade SMBâ€¦</span>')):g("Uso: nmap -sV <IP>");break;case"gobuster":n.includes("http://10.10.10.10")?(g("/backup (Status:301)\n/secret.txt (Status:200)"),t["/"].children.home.children.dev.children["FLAG1.txt"]={type:"file",content:"flag{g0bu5t3r_rocks}"},e.awardFlag(1,"g0bu5t3r_rocks",b)):g("Exemplo: gobuster dir -u http://10.10.10.10 -w â€¦");break;case"wireshark":g("Abrindo http_leak.pcapâ€¦ pacote 37: analyst / Passw0rd!"),e.awardFlag(2,"p4ck3t_sn1ff3r",b);break;case"hydra":n.includes("analyst")&&n.includes("Passw0rd")?(g("[22][ssh] host:10.10.10.10 login: analyst password: Passw0rd!"),b('<span class="info-message">Use su analyst</span>')):g("Ex.: hydra -l analyst -p Passw0rd! ssh://10.10.10.10");break;case"metasploit":case"msfconsole":n.includes("ms17_010")?(g("Exploit executado â€“ SYSTEM shell em 10.10.10.30"),e.awardFlag(3,"4dm1n_r00t_pwn3d",b)):b("Dica: use exploit/windows/smb/ms17_010_eternalblue â€¦");break;case"clear":a.innerHTML="";break;case"exit":window.location="/";break;default:g(`bash: ${s}: comando nÃ£o encontrado`,"error-message")}k()})(r.value),r.value=""):"ArrowUp"===n.key?(n.preventDefault(),m<u.length-1&&(r.value=u[++m])):"ArrowDown"===n.key&&(n.preventDefault(),m>0?r.value=u[--m]:(m=-1,r.value=""))};r.addEventListener("keydown",E),l&&l.addEventListener("click",()=>n.remove());b('<pre><span class="ascii-blue">\n                    ..:^~!77777777!!!~^^:..                 \n              .:^!77?77!~^:..:7????????????77!~^..          \n            ~??7!^:.          7???????????????????7.        \n        ^^   .                ?????????????????????:        \n        ^?.                  .~!!777???????????????: ^      \n      !.^?:       ...::^~~!777      ..^!7?????????7..7.     \n  .  .~ :?^                  .:..        :7???????7. .~^?:  \n  .J!~. :?!           .       !??7!^.      !??????!  ~!?:   \n   .7~^ .77.          ..      ~??????!:     7?????~ ...!.~^ \n ~7^!.^^.!?:          .~      ~????????~    ^?????: !Y?J?7. \n  ~!J7?: ^?~           !      ^?????????:   ^????7.:. .7    \n..  !  :~:7?.          7:     ^?????????.   ~????: !5?^!~?7.\n 7Y?7!Y5^ ^?7          7~     :???????!.   .????~   :~J!!~  \n  .:~?:  ..!?~         77.    :????7~.    .7???! .J! .!     \n     ~:.?Y. !?~        !?:    .7!^.     .~????~   ?5JJ~~~.  \n  .7?7JYY~  .!?!.      ~?!...^:      .:!?????^ :~  ~!:!!.   \n    ::.^^  ?^ ^??:     ^??????^  .:~7??????!.  ^5~:~.       \n      ..~!!Y: .:!?!.   :~^:.. .7?????????7: ~7  !!?J?~.     \n      ^77!^~  J! :7?!:         ????????!^7. 7Y^^.           \n           .~!Y! .?~!?7^.      ?????7~. 7Y^.:!J?7~.         \n         .~777^..^Y? .^7?!:    7?77~....^??!.               \n              .^7?7.....^!7?!:::.         .::.              \n              ...          .~7^ \n</span><span class="ascii-purple">        \n â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆ  â•”â•â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—\nâ–ˆâ–ˆ   â–ˆâ–ˆ â–ˆâ–ˆ   â–ˆâ–ˆ â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆ   â–ˆâ–ˆ â–ˆâ–ˆ â•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆ    â–ˆâ–ˆ â–ˆâ–ˆâ•”â•â•â•â•  \nâ–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆ â•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆ    â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    \nâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆ â•‘â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•— â•”â•â•â–ˆâ–ˆâ•‘      \nâ–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•\nâ•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â• â•šâ•â•â•â•  â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•\n</span>\n                                                By: Caio Duque â€“ v2025.3\n\n<span class="success-message">Iniciando Desafio CTF (Capture The Flag).</span>\nBem-vindo, Agente. Sua missÃ£o Ã© encontrar as trÃªs flags escondidas.\n\nUse <span class="info-message">help</span> para ver os comandos disponÃ­veis.\nBoa sorte!\n</pre>'),k(),r.focus()}class s{constructor(){this.tpl=document.getElementById("terminalTemplate"),this.cont=document.getElementById("kaliTerminalScreen"),this.count=1,document.addEventListener("click",e=>{e.target.classList.contains("plus")&&this.spawn()})}spawn(){const e=this.tpl.content.firstElementChild.cloneNode(!0);e.querySelectorAll("[id]").forEach(e=>{e.classList.contains("plus")||(e.id+="_"+this.count)}),this.cont.appendChild(e),n(e,this.count++)}}document.addEventListener("DOMContentLoaded",()=>{new s;n(document.querySelector(".terminal-window"),0)});